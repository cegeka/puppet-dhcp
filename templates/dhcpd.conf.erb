# dhcpd.conf

default-lease-time 600;
max-lease-time 7200;

<% if has_variable?( 'dnsupdatekey' ) -%>
ddns-update-style interim;
include "<%= dnsupdatekey %>";
<% dnsdomain.each do |dom| -%>
zone "<%= dom %>". {
  primary <%= nameservers.first %>;
  key "dhcp_updater";
}
<% end -%>
<% else %>
ddns-update-style none;
<% end -%>

option domain-name "<%= domain %>";
option domain-name-servers <%= nameservers.join( ', ') %>;
option ntp-servers <%= ntpservers.join( ', ') %>;
#authoritative;

#allow booting;
#allow bootp;

option fqdn.no-client-update    on;  # set the "O" and "S" flag bits
option fqdn.rcode2            255;
option pxegrub code 150 = text ;

<% if has_variable?( 'pxeserver' ) and has_variable?( 'filename' ) then -%>
# PXE Handoff.
next-server <%= pxeserver %>;
filename "<%= filename %>";
<% end -%>

log-facility <%= logfacility %>;

include "<%= dhcp_dir %>/dhcpd.pools";
include "<%= dhcp_dir %>/dhcpd.hosts";

